<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìë™ ë½€ëª¨ë„ë¡œ íƒ€ì´ë¨¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            color: #333;
        }
        .timer-container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 360px;
        }
        .settings {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        .settings div {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .settings label {
            font-size: 14px;
            color: #555;
            margin-bottom: 5px;
        }
        .settings input {
            width: 60px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: center;
            font-size: 16px;
        }
        #timer-display {
            font-size: 72px;
            font-weight: 600;
            margin: 10px 0;
            color: #d95550;
        }
        .buttons button {
            background-color: #4a90e2;
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 5px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }
        .buttons button:hover {
            background-color: #357abd;
        }
        #status, #cycle-info {
            font-size: 18px;
            font-weight: 500;
            color: #555;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<div class="timer-container">
    <div class="settings">
        <div>
            <label for="work-duration">ì§‘ì¤‘ ì‹œê°„ (ë¶„)</label>
            <input type="number" id="work-duration" value="25" min="1">
        </div>
        <div>
            <label for="break-duration">íœ´ì‹ ì‹œê°„ (ë¶„)</label>
            <input type="number" id="break-duration" value="5" min="1">
        </div>
        <div>
            <label for="cycles">ë°˜ë³µ íšŸìˆ˜</label>
            <input type="number" id="cycles" value="4" min="1">
        </div>
    </div>
    <div id="status">ì¤€ë¹„ë˜ì…¨ë‚˜ìš”? ğŸ…</div>
    <div id="timer-display">25:00</div>
    <div id="cycle-info">ë‚¨ì€ íšŸìˆ˜: 4</div>
    <div class="buttons">
        <button id="start">ì‹œì‘</button>
        <button id="pause">ì¼ì‹œì •ì§€</button>
        <button id="reset">ì´ˆê¸°í™”</button>
    </div>
</div>

<script>
    const timerDisplay = document.getElementById('timer-display');
    const startBtn = document.getElementById('start');
    const pauseBtn = document.getElementById('pause');
    const resetBtn = document.getElementById('reset');
    const statusDisplay = document.getElementById('status');
    const cycleInfo = document.getElementById('cycle-info');

    const workDurationInput = document.getElementById('work-duration');
    const breakDurationInput = document.getElementById('break-duration');
    const cyclesInput = document.getElementById('cycles');

    let countdown;
    let timeLeft;
    let isPaused = true;
    let isWorkSession = true;
    let currentCycle;
    let totalCycles;

    // *** ë³€ê²½ì  1: ì•ŒëŒ íŒŒì¼ ê²½ë¡œ ìˆ˜ì • ***
    // HTML íŒŒì¼ê³¼ ê°™ì€ í´ë”ì— ìˆëŠ” 'Clock-alarm-electronic-beep.mp3' íŒŒì¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
    const alarmSound = new Audio('Clock-alarm-electronic-beep.mp3');

    function initializeTimer() {
        timeLeft = workDurationInput.value * 60;
        totalCycles = cyclesInput.value;
        currentCycle = totalCycles;
        updateTimerDisplay();
        updateCycleInfo();
        statusDisplay.textContent = "ì¤€ë¹„ë˜ì…¨ë‚˜ìš”? ğŸ…";
        document.title = "ë½€ëª¨ë„ë¡œ íƒ€ì´ë¨¸";
    }

    function updateTimerDisplay() {
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        const display = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        timerDisplay.textContent = display;
        if (!isPaused) {
            document.title = `${display} - ${isWorkSession ? 'ì§‘ì¤‘ ì‹œê°„' : 'íœ´ì‹ ì‹œê°„'}`;
        }
    }

    function updateCycleInfo() {
        cycleInfo.textContent = `ë‚¨ì€ íšŸìˆ˜: ${currentCycle}`;
    }

    function startTimer() {
        if (isPaused) {
            isPaused = false;
            workDurationInput.disabled = true;
            breakDurationInput.disabled = true;
            cyclesInput.disabled = true;

            countdown = setInterval(() => {
                if (timeLeft > 0) {
                    timeLeft--;
                    updateTimerDisplay();
                } else {
                    alarmSound.play();
                    switchSession();
                }
            }, 1000);
        }
    }

    function pauseTimer() {
        isPaused = true;
        clearInterval(countdown);
    }

    function resetTimer() {
        pauseTimer();
        isPaused = true;
        isWorkSession = true;
        workDurationInput.disabled = false;
        breakDurationInput.disabled = false;
        cyclesInput.disabled = false;
        initializeTimer();
    }

    function switchSession() {
        clearInterval(countdown); // ì´ì „ íƒ€ì´ë¨¸ í™•ì‹¤íˆ ì œê±°
        isPaused = true;

        if (isWorkSession) { // ì§‘ì¤‘ ì„¸ì…˜ì´ ëë‚¬ì„ ë•Œ
            currentCycle--;
            if (currentCycle < 0) { // ëª¨ë“  ì„¸ì…˜ ì™„ë£Œ
                statusDisplay.textContent = "ëª¨ë“  ì„¸ì…˜ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! ğŸ‰";
                resetTimer();
                return;
            }
            isWorkSession = false;
            statusDisplay.textContent = "íœ´ì‹ ì‹œê°„! â˜•ï¸";
            timeLeft = breakDurationInput.value * 60;
        } else { // íœ´ì‹ ì„¸ì…˜ì´ ëë‚¬ì„ ë•Œ
            isWorkSession = true;
            statusDisplay.textContent = "ì§‘ì¤‘í•  ì‹œê°„! ğŸ…";
            timeLeft = workDurationInput.value * 60;
            updateCycleInfo();
        }
        
        updateTimerDisplay();

        // *** ë³€ê²½ì  2: ë‹¤ìŒ ì„¸ì…˜ ìë™ ì‹œì‘ ***
        startTimer();
    }

    startBtn.addEventListener('click', startTimer);
    pauseBtn.addEventListener('click', pauseTimer);
    resetBtn.addEventListener('click', resetTimer);
    workDurationInput.addEventListener('change', initializeTimer);
    breakDurationInput.addEventListener('change', initializeTimer);
    cyclesInput.addEventListener('change', initializeTimer);

    window.onload = initializeTimer;
</script>

</body>
</html>
